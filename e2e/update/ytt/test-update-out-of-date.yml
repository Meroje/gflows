setup:
  files:
    - path: .gflows/config.yml
      content: |
        templates:
          engine: ytt
    - path: .gflows/workflows/test.jsonnet
      content: |
        'on':
          push:
            branches: ['develop']
        jobs:
          hello:
            runs-on: ubuntu-latest
            steps:
              - run: echo hello, world!
    - path: .github/workflows/test.yml

run: update

expect:
  output: |2
         update .github/workflows/test.yml (from .gflows/workflows/test)
  files:
  - path: .gflows/config.yml
  - path: .gflows/workflows/test/config.yml
  - path: .github/workflows/test.yml
    content: |
      # File generated by gflows, do not modify
      # Source: .gflows/workflows/test.jsonnet
      "jobs":
        "hello":
          "runs-on": "ubuntu-latest"
          "steps":
          - "run": "echo hello, world!"
      "on":
        "push":
          "branches":
          - "develop"
